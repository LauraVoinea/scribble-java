module Calculator;

global protocol Calc(role Alice, role Carol, role Server){
    element_1() from Carol to Server;
    element_2() from Carol to Server;

    mixed{
         choice at Carol {
               sum() from Carol to Server;
               result() from Server to Carol;
               sum_result() from Carol to Alice;
           } or {
               diff() from Carol to Server;
               result() from Server to Carol;
               diff_result() from Carol to Alice;
           }
       } () or Carol -> Server() {
           timeout() from Server to Carol;
           cancel() from Carol to Alice;
    }
}