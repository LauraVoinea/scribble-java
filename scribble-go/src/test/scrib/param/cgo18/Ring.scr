//Raymond@HZHL3 ~/code/eclipse/scribble/github.com/rhu1-go/scribble-java
//$ bin/scribblec-go.sh -ip scribble-go/src/test/scrib/ -d scribble-go/src/test/scrib/ scribble-go/src/test/scrib/param/cgo18/Ring.scr -param Proto1

module param.cgo18.Ring;


type <go> "int" from "..." as int;


global protocol Proto1(role B(k))
{
	m1(int) dot B[1..k] to B[2..k+1];
	m1(int) dot B[k+1..k+1] to B[1..1];
	m1(int) dot B[1..k] to B[2..k+1];
	m1(int) dot B[k+1..k+1] to B[1..1];
	//...
	m1(int) dot B[1..k] to B[2..k+1];
	m1(int) dot B[k+1..k+1] to B[1..1];
}


global protocol Proto2(role B(k))
{
	choice at B[1]
	{
		m1(int) from B[1..1] to B[2..k+1];
		m1(int) dot B[1..k] to B[2..k+1];
		m1(int) dot B[k+1..k+1] to B[1..1];

		do Proto2(B);
	}
	or
	{
		m2(int) from B[1..1] to B[2..k+1];
		m2(int) dot B[1..k] to B[2..k+1];
		m2(int) dot B[k+1..k+1] to B[1..1];
	}
}


/*
global protocol Proto3(role B(k))
{
	choices at B[i:1..k+1]
	{
		m1(int) from B[i] to B[i+1];  // Projection at dest?
		m1(int) dot B[k+1..k+1] to B[1..1];

		do Proto3(B);
	}
	or
	{
		m2(int) from B[i] to B[i+1];
		m2(int) dot B[k+1..k+1] to B[1..1];
	}
}
//*/



/*
global protocol Proto1(role B(k))  // FIXME: role param WF -- params only for root protos?
{
	choice at B[1]  // FIXME: role index WF?
	{
		//m1(int) dot B[1..k-1] to B[2..k];  // FIXME: k>2 global invariant  // FIXME: range-sensitive role enabling -- a Scribble-specific issue, choice subjs
		//m1(int) dot B[k..k] to B[1..1];

		//m1(int) dot B[1..k] to B[2..k+1];
		//m1(int) dot B[k+1..k+1] to B[1..1];

		m1(int) from B[1..1] to B[2..k+1];
		m1(int) dot B[1..k] to B[2..k+1];
		m1(int) dot B[k+1..k+1] to B[1..1];

		do Proto1(B);  // FIXME: role params? or disallow role permuting?
	}
	or
	{
		//m2(int) dot B[1..k-1] to B[2..k];
		//m2(int) dot B[k..k] to B[1..1];

		m2(int) from B[1..1] to B[2..k+1];
		m2(int) dot B[1..k] to B[2..k+1];
		m2(int) dot B[k+1..k+1] to B[1..1];
	}
}
//*/
